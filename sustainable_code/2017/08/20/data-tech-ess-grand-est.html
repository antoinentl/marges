<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>L&#39;appel des SIRENE</title>
  <meta name="description" content="Un jour de pont, succomber à l’appel des données ouvertes du répertoire SIRENE, se prendre quelques récifs, mais découvrir quand même de jolis recoins.">
  <meta name="author" content="Claire Zuliani" />
  <link rel="shortcut icon" type="image/x-icon" href="http://marges.clairezuliani.com/assets/img/favicon.ico">


  <meta property="og:site_name" content="Marges" />
  <meta property="og:title" content=" L'appel des SIRENE ">
  <meta property="og:description" content="   Un jour de pont, succomber à l’appel des données ouvertes du répertoire SIRENE, se prendre quelques récifs, mais découvrir quand même de jolis recoins.
    ">
  <meta property="og:url" content="http://marges.clairezuliani.com/sustainable_code/2017/08/20/data-tech-ess-grand-est.html" />
  <meta property="og:locale" content="fr_FR" />

  <meta name="twitter:site" content="@ZooletteDesBois" />
  <meta name="twitter:description" content="Un jour de pont, succomber à l’appel des données ouvertes du répertoire SIRENE, se prendre quelques récifs, mais découvrir quand même de jolis recoins." />


    <!-- Article specific OG data -->
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2017-08-20 00:00:00 +0200" />
    <meta property="article:author" content="Claire Zuliani" />
    <meta property="article:publisher" content="Claire Zuliani" />
    <meta property="article:section" content="code décroissant" />
    
      <meta property="article:tag" content="données" />
    
      <meta property="article:tag" content="cartographie" />
    

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@ZooletteDesBois" />
    <meta name="twitter:title" content="L'appel des SIRENE" />
  
      <meta property="og:image" content="http://marges.clairezuliani.com/img/marges_default.png" />
      <meta name="twitter:image" content="http://marges.clairezuliani.com/img/marges_square_200.png" />
    
      
  <link rel="stylesheet" href="/assets/css/spectre.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/icomoon.css">
  <link rel="canonical" href="http://marges.clairezuliani.com/sustainable_code/2017/08/20/data-tech-ess-grand-est.html">
  <link rel="alternate" type="application/rss+xml" title="Marges" href="http://marges.clairezuliani.com/feed.xml">
  <script src="/assets/js/jquery-2.2.3.min.js" type="text/javascript"></script>
  <script src="/assets/js/main.js" type="text/javascript"></script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//stats.clairezuliani.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

</head>


<body>

  <div class="layout-container">

    <div class="layout-container_inner">

      <aside class="nav desktop-nav">
        <div class="menu-wrapper">

  <a class="menu-title  site-title" href="/">
    Marges
  </a>

  <div class="menu-section">
    <p><em>Carnet de notes de <a href="http://www.clairezuliani.com/" target="_blank">Claire Zuliani</a>, dans les marges des internets.</em></p>
  </div>

  <ul class="menu">
    <li class="menu-item">
      <a class="item" href="/recherche">
        <span class="icon icon-search"></span>
        Rechercher
      </a>
    </li>
  </ul>

  <ul class="menu">
    <li class="menu-header">
      Formats
    </li>

    <li class="menu-item ">
      <a class="item" href="/depeches">
        Dépêches
        <span class="menu-label">88</span>
      </a>
    </li>
    <li class="menu-item ">
      <a class="item" href="/dossiers">
        <span> Dossiers </span>
        <span class="menu-label">11</span>
      </a>
    </li>
  </ul>

  <ul class="menu">
  <li class="menu-header"> Lubies </li>
  
    
    <li class="menu-item ">
      <a class="item"  href="/lubies/binary_transition">
        Transition binaire
       <div class="menu-label">23</div>
      </a>
    </li>
  
    
    <li class="menu-item active">
      <a class="item"  href="/lubies/sustainable_code">
        Code décroissant
       <div class="menu-label">28</div>
      </a>
    </li>
  
    
    <li class="menu-item ">
      <a class="item"  href="/lubies/good_job">
        Good job
       <div class="menu-label">37</div>
      </a>
    </li>
  
  </ul>

  <ul class="menu">
    <li class="menu-header"> Tags (39) </li>
    
    
      <li class="menu-item  ">
        <a class="item" href="/tags/a lire">
         a lire
         <div class="menu-label">3</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/association">
         association
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/bonheur">
         bonheur
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/cartographie">
         cartographie
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/civic tech">
         civic tech
         <div class="menu-label">9</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/code">
         code
         <div class="menu-label">4</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/collectivites">
         collectivites
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/color">
         color
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/communs">
         communs
         <div class="menu-label">6</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/cooperative">
         cooperative
         <div class="menu-label">6</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/design">
         design
         <div class="menu-label">14</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/detox">
         detox
         <div class="menu-label">3</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/devops">
         devops
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/données">
         données
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/dont be evil">
         dont be evil
         <div class="menu-label">6</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/ecologie">
         ecologie
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/empowerment">
         empowerment
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/engagement">
         engagement
         <div class="menu-label">3</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/ess">
         ess
         <div class="menu-label">5</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/et moi">
         et moi
         <div class="menu-label">14</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/ethique">
         ethique
         <div class="menu-label">6</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/evenement">
         evenement
         <div class="menu-label">12</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/faire a plusieurs">
         faire a plusieurs
         <div class="menu-label">9</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/financement">
         financement
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/freelancing">
         freelancing
         <div class="menu-label">3</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/gif power">
         gif power
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/hacking">
         hacking
         <div class="menu-label">3</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/hebdomalink">
         hebdomalink
         <div class="menu-label">9</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/open source">
         open source
         <div class="menu-label">6</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/plateformes">
         plateformes
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/politique">
         politique
         <div class="menu-label">7</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/radiographie">
         radiographie
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/reference">
         reference
         <div class="menu-label">2</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/start up">
         start up
         <div class="menu-label">4</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/sécurité">
         sécurité
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/tech-washing">
         tech-washing
         <div class="menu-label">4</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/tiers-lieux">
         tiers-lieux
         <div class="menu-label">1</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/toolkit">
         toolkit
         <div class="menu-label">6</div>
        </a>
      </li>
    
      <li class="menu-item  ">
        <a class="item" href="/tags/ui/ux">
         ui/ux
         <div class="menu-label">4</div>
        </a>
      </li>
    
  </ul>

  <ul class="menu">
    <li class="menu-item">
      <a class="item" href="/c-est-quoi-don">
        A propos
      </a>
    </li>
  </ul>


</div>

      </aside>

      <div class="nav mobile-header">
        <div class="mobile-header_wrapper">
          <a class="mobile-menu_title site-title" href="/">
            Marges
          </a>
          <a href="javascript:void(0)" class="btn btn-link btn-lg" data-toggle="mobile-nav"><i class="icon icon-menu"></i></a>
        </div>
      </div>

      <nav class="nav mobile-nav" data-toggled="mobile-nav">
        
      <div class="menu-wrapper">
        <ul class="menu">
          <li class="menu-item">
            <a class="item" href="/recherche">
              <span class="icon icon-search"></span>
              Rechercher
            </a>
          </li>
        </ul>



        <ul class="menu">
          <li class="menu-header">Format</li>
          <li class="menu-item">
            <a class="item" href="/depeches">
              Dépêches
              <div class="menu-label">88</div>
            </a>
          </li>
          <li class="menu-item">
            <a class="item" href="/dossiers">
              Dossiers
              <div class="menu-label">11</div>
            </a>
          </li>
        </ul>

        <ul class="menu">
          <li class="menu-header">Lubies</li>
            
              
              <li class="menu-item">
              <a class="item"  href="/lubies/binary_transition">
                Transition binaire
               <div class="menu-label">23</div>
              </a>
            
              
              <li class="menu-item">
              <a class="item"  href="/lubies/sustainable_code">
                Code décroissant
               <div class="menu-label">28</div>
              </a>
            
              
              <li class="menu-item">
              <a class="item"  href="/lubies/good_job">
                Good job
               <div class="menu-label">37</div>
              </a>
            
          </li>
        </ul>

        <ul class="menu">
          <li class="menu-header">Tags (39)</li>
          
          
            <li class="menu-item">
              <a class="item" href="/tags/a lire">
               a lire
               <div class="menu-label">3</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/association">
               association
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/bonheur">
               bonheur
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/cartographie">
               cartographie
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/civic tech">
               civic tech
               <div class="menu-label">9</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/code">
               code
               <div class="menu-label">4</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/collectivites">
               collectivites
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/color">
               color
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/communs">
               communs
               <div class="menu-label">6</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/cooperative">
               cooperative
               <div class="menu-label">6</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/design">
               design
               <div class="menu-label">14</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/detox">
               detox
               <div class="menu-label">3</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/devops">
               devops
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/données">
               données
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/dont be evil">
               dont be evil
               <div class="menu-label">6</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/ecologie">
               ecologie
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/empowerment">
               empowerment
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/engagement">
               engagement
               <div class="menu-label">3</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/ess">
               ess
               <div class="menu-label">5</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/et moi">
               et moi
               <div class="menu-label">14</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/ethique">
               ethique
               <div class="menu-label">6</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/evenement">
               evenement
               <div class="menu-label">12</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/faire a plusieurs">
               faire a plusieurs
               <div class="menu-label">9</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/financement">
               financement
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/freelancing">
               freelancing
               <div class="menu-label">3</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/gif power">
               gif power
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/hacking">
               hacking
               <div class="menu-label">3</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/hebdomalink">
               hebdomalink
               <div class="menu-label">9</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/open source">
               open source
               <div class="menu-label">6</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/plateformes">
               plateformes
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/politique">
               politique
               <div class="menu-label">7</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/radiographie">
               radiographie
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/reference">
               reference
               <div class="menu-label">2</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/start up">
               start up
               <div class="menu-label">4</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/sécurité">
               sécurité
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/tech-washing">
               tech-washing
               <div class="menu-label">4</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/tiers-lieux">
               tiers-lieux
               <div class="menu-label">1</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/toolkit">
               toolkit
               <div class="menu-label">6</div>
              </a>
            </li>
            
            <li class="menu-item">
              <a class="item" href="/tags/ui/ux">
               ui/ux
               <div class="menu-label">4</div>
              </a>
            </li>
            
        </ul>

        <ul class="menu">
          <li class="menu-item">
            <a class="item" href="/c-est-quoi-don">
              A propos
            </a>
          </li>
        </ul>
      </div>

      </nav>

      <div class="layout-main">
        <div class="content-wrapper">
          <article class="card" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="page-header card-header">
    <h1 class="post-title" itemprop="name headline">
      <span>L'appel des SIRENE</span>
    </h1>
  </header>

  <div class="post-content card-body" itemprop="articleBody">
    <p>Un jour de pont, succomber à l’appel des données ouvertes du répertoire SIRENE, se prendre quelques récifs, mais découvrir quand même de jolis recoins.</p>

<!--more-->

<p>Comme les journées sont plus longues l’été, encore plus les week-end de pont, j’ai profité de la mi-août pour me plonger gouluement dans le répertoire SIRENE et joindre l’utile à l’agréable.</p>

<p>L’agréable&nbsp;: jouer avec des données, apprendre à les manipuler (traitement, nettoyage, visualisation), découvrir les terribles secrets qu’elles renferment.</p>

<p>L’utile&nbsp;: choisir des terrains d’exercice tout à fait intéressés, ausculter les organismes de l’Economie Sociale et Solidaire (ESS) du coin (potentiels clients) et pister les boites de com’ ou de développement des environs (potentiels concurrents ou partenaires).</p>

<p>Ci-dessous, un résumé du déroulé des opérations, où je vous épargnerai le détail des impasses et faux plans dans lesquels je me suis laissée embarquer, pour directement sauter aux solutions que j’ai pu trouver.</p>

<p><em>Précision&nbsp;: je parle ici du haut de mon expérience de quelques bonnes poignées d’heure. Il va sans dire que mes solutions sont probablement loin d’être les plus efficaces ou pertinentes. Mais ça épargnera peut-être quelques heures de galère à ceux qui se lancent comme moi tête la première dans un océan de données. Au moins, ça les épargnera à mon moi futur, quand il lui reprendra de tripatouiller de la donnée.</em></p>

<h2 id="ma-boîte-à-outils">Ma boîte à outils</h2>

<p>En guise d’introduction, voilà les outils que je me suis retrouvée à exploiter pendant ma quête du 15 août&nbsp;:</p>

<ul>
  <li>python</li>
  <li>un tableur basique</li>
  <li><a href="https://pandas.pydata.org/">pandas</a>, librairie python d’analyse des données</li>
  <li><a href="https://carto.com/">carto</a>, service de cartographie et d’analyse de données en ligne</li>
  <li><a href="https://my.datascientistworkbench.com/tools/openrefine">openRefine</a>, logiciel libre de nettoyage et de mise en forme de données.</li>
</ul>

<h2 id="traitement">Traitement</h2>

<h3 id="etape-1--trouver-les-données-et-les-comprendre">Etape 1&nbsp;: Trouver les données et les comprendre</h3>

<p>L’ouverture du répertoire SIRENE début 2017 est quand même une formidable opportunité d’en savoir plus sur la typologie des organisations en France. Les données sont maintenant accessibles en csv, mises à jour tous les jours.</p>

<p>Pour les trouver, rendez-vous sur <a href="https://www.data.gouv.fr/en/datasets/base-sirene-des-entreprises-et-de-leurs-etablissements-siren-siret/">www.data.gouv.fr</a>.</p>

<p>Si vous voulez l’intégralité des donnés et non les mises à jour quotidiennes, bien télécharger un fichier «&#8239;stock&#8239;» de début de mois. Vous devriez pas vous tromper&nbsp;: si vous mettez moins de 10 minutes à le télécharger, a priori c’est pas le bon (8,6 GB tout de même).</p>

<p>Ensuite, pour savoir quoi chercher, arpenter la nomenclature. Un <a href="https://www.sirene.fr/static-resources/doc/dessin_L2_description_complete.pdf?version=1.14">pdf explicatif</a> est disponible, ce qui épargnera les allers-retours pénibles dans la <a href="https://www.sirene.fr/sirene/public/static/liste-variables">liste des variables sirene</a> en ligne. (je me suis fait un petit  <a href="https://gist.github.com/clairezed/cd69498f75a3e2768eef54e7af3c7536">pense-bête</a> un peu plus synthétique).</p>

<p>J’apprends qu’il y a une <a href="https://www.sirene.fr/sirene/public/variable/syr-ess">variable ESS</a>, c’est celle-là que je vais utiliser pour commencer et cibler les organismes dans le champs de l’ESS.</p>

<p>Pour les structures faisant potentiellement du développement web, j’ai commencé par aller chercher les codes APE de quelques sociétés auxquels je me compare (une recherche sur <a href="https://www.societe.com/cgi-bin/search">societe.com</a> suffit bien), puis ai fouillé ces codes et les codes proches sur le site de l’<a href="https://www.insee.fr/fr/metadonnees/nafr2/division/62">insee</a> (au passage&nbsp;: bon point pour l’insee, j’ai trouvé leur interface claire, pratique, bien pensée).</p>

<p>Je garderais les codes suivants&nbsp;:</p>
<ul>
  <li>5829A&nbsp;: Édition de logiciels système et de réseau</li>
  <li>6201Z&nbsp;: Programmation informatique</li>
  <li>6202A&nbsp;: Conseil en systèmes et logiciels informatiques</li>
  <li>6202B&nbsp;: Tierce maintenance de systèmes et d’applications informatiques</li>
  <li>6203Z&nbsp;: Gestion d’installations informatiques</li>
  <li>6209Z&nbsp;: Autres activités informatiques</li>
  <li>6311Z&nbsp;: Traitement de données, hébergement et activités connexes</li>
  <li>6312Z&nbsp;: Portails Internet</li>
  <li>7022Z&nbsp;: Conseil pour les affaires et autres</li>
  <li>7311Z&nbsp;: Activités des agences de publicité</li>
</ul>

<h3 id="etape-2--vérifier-les-données">Etape 2&nbsp;: vérifier les données</h3>

<p>Pour avoir une idée un peu plus précise de la tête des données, vérifier quels champs sont bien présents dans le fichier qu’on a récupérer, je conseille  d’en extraire dans un fichier temporaire les 10 premières lignes, pour études.</p>

<p>En console&nbsp;:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>head -n 10 source.csv &gt; destination.csv
</code></pre>
</div>

<p>Ce qui permet de découvrir que les données ont cette tête-là&nbsp;:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>"SIREN";"NIC";"L1_NORMALISEE";"L2_NORMALISEE";"L3_NORMALISEE"...
</code></pre>
</div>

<p>Un point virgule comme séparateurs, toutes les données enserrées dans des double quotes. Une information à connaître pour pouvoir configurer correctement ses scripts de manipulation de données. L’ouverture de l’extrait avec un tableur m’a aussi permis de constater que le fichier n’était pas encodé en utf-8, il y aura donc aussi ce point-là à prendre en compte.</p>

<h3 id="etape-3--trancher-dans-le-lard">Etape 3&nbsp;: trancher dans le lard</h3>

<p>Un fichier csv de 8,6 giga, c’est lourd. C’est très lourd. Ce n’est pas du tout manipulable dans un tableur, par exemple (non, n’essayez pas).</p>

<p>J’ai découvert au fil du temps, et après trop de maltraitance de mon ordinateur, qu’à cette étape du projet il est capital&nbsp;:</p>
<ul>
  <li>d’écrémer sérieusement et de ne conserver que les données sur lesquelles on va travailler,</li>
  <li>de faire cet écrémage avec des outils permissifs, pas raffiné pour deux sous, qui s’en foutent du typage, qui s’en tapent de l’encodage, etc. Pas même utiliser <code class="highlighter-rouge">DictReader</code> vu que les données sont formatées bizarrement, et qu’à la moindre erreur votre machine est susceptible d’imploser.</li>
</ul>

<p>Et donc, un bon vieux script python de derrière les fagots fait le job&nbsp;:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">source_file</span> <span class="o">=</span> <span class="s">"source.csv"</span>
<span class="n">dest_file</span>   <span class="o">=</span> <span class="s">"tech_grand_est_00.csv"</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">header</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">";"</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">header</span>
    <span class="k">print</span> <span class="n">header</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">';'</span><span class="p">)</span>
    <span class="c">### Filtrage des codes APE</span>
    <span class="n">results</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'5829A'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6201Z'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6202A'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6202B'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6203Z'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6209Z'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6311Z'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'6312Z'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'7311Z'</span> <span class="ow">or</span>
                                 <span class="n">row</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">==</span> <span class="s">'7410Z'</span><span class="p">,</span> <span class="n">reader</span><span class="p">)</span>
    <span class="c">### Ou bien filtrage par code ESS :</span>
    <span class="c"># results = filter(lambda row: row[76] == 'O', reader)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_file</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre>
</div>

<p>Une vérification rapide des données, en extrayant les premières lignes, ça mange pas de pain.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>head -n 10 tech_grand_est_00.csv &gt; tech_grand_est_00_fl.csv
</code></pre>
</div>

<h3 id="etape-4--encoding-continuer-à-réduire">Etape 4&nbsp;: encoding, continuer à réduire</h3>

<p>Cette fois on peut passer à pandas, librairie python dédiée à la manipulation de données, pour y voir plus clair&nbsp;:  formater le header, passer l’encodage de <code class="highlighter-rouge">iso-8859-1</code> à <code class="highlighter-rouge">utf-8</code>….</p>

<script src="https://gist.github.com/clairezed/c21fb505188f47a68f186e9f1271bee9.js"></script>

<h3 id="etape-5--filtrage-des-colonnes-formattage-du-type-des-données">Etape 5&nbsp;: filtrage des colonnes, formattage du type des données</h3>

<p>Le header est formaté correctement, on peut maintenant filtrer les colonnes en ne conservant que celles dont on va se servir.</p>

<p>A cette étape, j’en profite aussi pour réparer les formattages approximatifs fait par pandas. Voilà ce que c’est que d’utiliser des outils surpuissants sans avoir compulsé le mode d’emploi&#8239;; on se retrouve avec plein d’effets de bord pas du tout anticipé.</p>

<p>Par exemple le fait que dans pandas, les données sont typées (date, nombre, text…), et que de base tout ce qui est perçu comme nombre par pandas est typé comme un <code class="highlighter-rouge">float</code>. Et quand les codes postaux sont enregistrés sous le format <code class="highlighter-rouge">75011.0</code>, le géocodage est plus compliqué.</p>

<p>Réparons tout ça&nbsp;:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">source_file</span> <span class="o">=</span> <span class="s">"tech_grand_est_01.csv"</span>
<span class="n">dest_file</span>   <span class="o">=</span> <span class="s">"tech_grand_est_02.csv"</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s">','</span> <span class="p">,</span>
    <span class="n">error_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span>
    <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s">'SIREN'</span><span class="p">,</span> <span class="s">'L1_NORMALISEE'</span><span class="p">,</span> <span class="s">'L2_NORMALISEE'</span><span class="p">,</span>
    <span class="s">'NUMVOIE'</span><span class="p">,</span> <span class="s">'INDREP'</span><span class="p">,</span> <span class="s">'TYPVOIE'</span><span class="p">,</span> <span class="s">'LIBVOIE'</span><span class="p">,</span> <span class="s">'CODPOS'</span><span class="p">,</span>
    <span class="s">'DEPET'</span><span class="p">,</span> <span class="s">'LIBREG'</span><span class="p">,</span> <span class="s">'LIBCOM'</span><span class="p">,</span> <span class="s">'TU'</span><span class="p">,</span>
    <span class="s">'APET700'</span><span class="p">,</span> <span class="s">'LIBAPET'</span><span class="p">,</span> <span class="s">'TEFET'</span><span class="p">,</span> <span class="s">'LIBTEFET'</span><span class="p">,</span> <span class="s">'EFETCENT'</span><span class="p">,</span> <span class="s">'DCRET'</span><span class="p">,</span>
    <span class="s">'NJ'</span><span class="p">,</span> <span class="s">'LIBNJ'</span><span class="p">,</span> <span class="s">'ESS'</span><span class="p">,</span> <span class="s">'DATEESS'</span><span class="p">,</span> <span class="s">'CATEGORIE'</span><span class="p">]</span>
<span class="p">)</span>

<span class="c"># replace 'NN' value with a numeric one (so as to cast afterwards)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'TEFET'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'NN'</span><span class="p">,</span> <span class="s">'0'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c">### temporarely replace empty (NaN values) with 0, so as to cast afterwards</span>
<span class="n">df</span><span class="p">[</span><span class="s">'NUMVOIE'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'NUMVOIE'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'DATEESS'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'DATEESS'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'NJ'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'NJ'</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">df</span><span class="p">[[</span><span class="s">'TU'</span><span class="p">,</span> <span class="s">'CODPOS'</span><span class="p">,</span> <span class="s">'DCRET'</span><span class="p">,</span> <span class="s">'TEFET'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'TU'</span><span class="p">,</span> <span class="s">'CODPOS'</span><span class="p">,</span> <span class="s">'DCRET'</span><span class="p">,</span> <span class="s">'TEFET'</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s">'NJ'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'0'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'DATEESS'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'0'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">dest_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="etape-6--soccuper-des-dates">Etape 6&nbsp;: s’occuper des dates</h3>

<p>Là, je galèrais trop avec pandas, je suis donc repassée à du python basique.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">source_file</span> <span class="o">=</span> <span class="s">"tech_grand_est_02.csv"</span>
<span class="n">dest_file</span>   <span class="o">=</span> <span class="s">"tech_grand_est_03.csv"</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_file</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">','</span><span class="p">)</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="n">reader</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">row</span><span class="p">[</span><span class="s">'DCRET'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">'DCRET'</span><span class="p">],</span> <span class="s">"</span><span class="si">%</span><span class="s">Y</span><span class="si">%</span><span class="s">m</span><span class="si">%</span><span class="s">d"</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s">'DATEESS'</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">""</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">'skip'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="s">'DATEESS'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">'DATEESS'</span><span class="p">],</span> <span class="s">"</span><span class="si">%</span><span class="s">Y</span><span class="si">%</span><span class="s">m</span><span class="si">%</span><span class="s">d"</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="etape-6-bis--transformation-des-données">Etape 6 bis&nbsp;: transformation des données</h3>

<p>Pour créer une carte permettant de comparer la densité d’établissements dans le Grand Est par rapport au reste de la France, il me fallait extraire le nombre d’établissement de l’ESS par département. C’est le genre de manipulation pour lequel pandas est typiquement approprié.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">source_file</span> <span class="o">=</span> <span class="s">"sirc-201707_L_M_ESS_cleaned.csv"</span>
<span class="n">dest_file</span> <span class="o">=</span> <span class="s">"sirene_ESS_grouped_dept.csv"</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s">','</span> <span class="p">,</span>
    <span class="n">error_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s">'SIREN'</span><span class="p">,</span><span class="s">'DEPET'</span><span class="p">,</span> <span class="s">'LIBREG'</span><span class="p">],</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span>

<span class="n">group_by_dpt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'DEPET'</span><span class="p">,</span> <span class="s">'LIBREG'</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">df_dept</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">group_by_dpt</span><span class="p">)</span>
<span class="n">df_dept</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">dest_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="etape-7--géocoder">Etape 7&nbsp;: géocoder</h3>

<p>Pour afficher les établissements sur une carte, on a besoin de leurs coordonnées GPS, qui ne sont pas présentes dans les fichiers SIRENE.</p>

<p>Trouver un service en ligne de geocoding&nbsp;:  <a href="https://adresse.data.gouv.fr/csv">adresse.data.gouv.fr</a> remplit nickel la mission.</p>

<p>Une fois récupéré le fichier csv, reste à faire le tri dans les colonnes qu’on veut conserver parmi celles qui ont été rajoutées dans le géocodage.</p>

<p>Les données sont propres, complètes, formatées. Prêtes à révéler leurs secrets (tadaaaaaaaaaaa&#8239;!).</p>

<h2 id="analyse-et-résultats">Analyse et résultats</h2>

<p>J’avais dans l’idée de présenter les résultats de mes expérimentations ESS sous forme de carte, mais vu le temps déjà passé à préparer les données, je n’avais aucune envie d’en plus avoir à apprendre une librairie de visualisation (à la <a href="https://d3js.org/">d3.js</a>).</p>

<p>J’avais cru repérer que <a href="https://carto.com/">carto.com</a>, tout propriétaire qu’il soit, permettait d’avoir des résultats bien propres et avait un plan gratuit.</p>

<p>J’ai donc sauter dessus, et voici les résultats&nbsp;:</p>

<iframe width="100%" height="520" frameborder="0" src="https://clairezed.carto.com/builder/c4a132ad-501d-49a9-a877-a9b5686a208a/embed" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" oallowfullscreen="" msallowfullscreen=""></iframe>

<iframe width="100%" height="520" frameborder="0" src="https://clairezed.carto.com/builder/b04bcbf6-8ee2-4d58-9911-c374bce6cc44/embed" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" oallowfullscreen="" msallowfullscreen=""></iframe>

<p>Verdict&nbsp;: après un temps très raisonnable d’apprentissage, carto fait gagner beaucoup de temps, et très agréable à utiliser, et propose en quelques clics des modules qui permettent de filtrer les données très puissants.</p>

<p>N’hésitez pas à jouer un peu avec les petits modules «&#8239;Région&#8239;», «&#8239;Ratio&#8239;», «&#8239;Activité&#8239;»… pour comparer les données plus finement. Un vrai piège à temps.</p>

<p>Si vous voulez voir et manipuler les cartes en grand, directement sur carto.com&nbsp;:</p>
<ul>
  <li><a href="https://clairezed.carto.com/builder/c4a132ad-501d-49a9-a877-a9b5686a208a/embed?state=%7B%22map%22%3A%7B%22ne%22%3A%5B39.926588421909436%2C-7.668457031250001%5D%2C%22sw%22%3A%5B52.26815737376817%2C12.106933593750002%5D%2C%22center%22%3A%5B46.44542749723387%2C2.2192382812500004%5D%2C%22zoom%22%3A6%7D%2C%22widgets%22%3A%7B%22815bb82d-1bb0-47e0-8dc7-f28747846f74%22%3A%7B%22normalized%22%3Atrue%7D%7D%7D">Densité des établissements ESS France</a></li>
  <li><a href="https://clairezed.carto.com/builder/b04bcbf6-8ee2-4d58-9911-c374bce6cc44/embed">Etablissements ESS en Lorraine</a></li>
</ul>

<h3 id="openrefine">OpenRefine</h3>

<p>Pour la liste des établissements faisant du web, je ne voyais pas de plus-value à les mettre directement sur une carte. Je voulais en priorité jouer avec les données brutes, faire des recoupements facilement, etc.</p>

<p>J’ai donc préféré les importer dans <a href="http://openrefine.org/">OpenRefine</a> (<a href="https://my.datascientistworkbench.com/tools/openrefine">version en ligne</a>) pour estimer ce que je pouvais en tirer.</p>

<p>Résultat&nbsp;: pas grand chose de probant.</p>

<ul>
  <li>Les Vosges sont le 6<sup>e</sup> établissement sur 12 étudiés pour le nombre de potentiels professionnels du web.</li>
  <li>J’aurais aimé, dans les Vosges, pouvoir faire le tri entre les auto (micro) entreprise et les autres société, mais je ne possède pas d’information sur la nature juridique de l’entreprise pour la grande majorité des établissements.</li>
  <li>Le type d’info peut être fourni par le nombre de salarié, mais exclu de fait les sociétés à plusieurs sociétaire sans salariés.</li>
</ul>

<p>Bref, ce sera à affiner, et j’essaierai de croiser avec d’autres données une prochaine fois.</p>

<h2 id="conclusions">Conclusions</h2>

<p>Quelques éléments de conclusion après deux jours dans le monde des données&nbsp;:</p>

<ul>
  <li>
    <p>récupérer des sources et apprendre à les connaître (quelle colonne correspond à quoi&#8239;? Quelle donnée peut m’intéresser&#8239;? Est-elle renseignée systématiquement&#8239;?) demande beaucoup de temps. Et encore, je n’étais ici que sur des données ultra balisées (SIRENE).</p>
  </li>
  <li>
    <p>Apprendre de nouveaux outils, c’est toujours long (ici&nbsp;: pandas + carto).</p>
  </li>
  <li>
    <p>Récupérer des données dont les champs sont mal formatés ou pas formaté avec consistance complique la tâche. Dans le répertoire SIRENE, certains champs booléens (oui / non) sont parfois représentés par des chiffres (1 / 0), d’autres fois par des lettres (O / N)… Quand on utilise en plus un outil de traitement avec un système de typage fort, ça peut très vite devenir le bazar.</p>
  </li>
  <li>
    <p>Je reste toujours sacrément plus à l’aise sur des outils visuels, mais apprendre un peu de python est + qu’utile pour les gros traitements impossibles à faire par d’autres moyens (fichiers de plusieurs gigabytes…)</p>
  </li>
  <li>
    <p>C’est compliqué de manipuler des fichiers «&#8239;à l’aveugle&#8239;» (fichiers trop gros), et le risque d’exclure sans le savoir des données qui pourraient être intéressantes est réel. Je sais par exemple que pandas a exclu d’office certaines lignes du CSV qui ne correpondait pas à je ne sais quelle norme (non détectée en faisant des tests sur un extrait plus court du fichier). Et j’ai donc été surprise de ne pas retrouver dans mon fichier final des entreprises du web une société d’Epinal que j’avais en tête, sortie à je ne sais quel moment de mes manipulations. Réussir à prendre en compte absolument toutes les données est un travail de titan.</p>
  </li>
  <li>
    <p>J’ai découvert sur le tard des outils qui rendent inutiles la plus grosse part des manipulations que j’aie eu à faire, super. L’<a href="https://data.opendatasoft.com/explore/dataset/sirene%40public/api/">API Sirene</a> proposée par OpenDataSoft permet de faire un grand nombre de recherche sur le répertoire SIRENE, et d’exporter les résultats. En plus les adresses sont déjà géocodées. Heureusement, tous les filtres (notamment code ESS) ne sont pas présnets, ce qui m’a éviter de me dire à 100&#8239;% que mon travail avait été inutile.</p>
  </li>
  <li>
    <p>enfin, un lien que je voulais garder sous la main pour plus tard&nbsp;: <a href="https://gist.github.com/bsweger/e5817488d161f37dcbd2">Useful Pandas Snippets</a></p>
  </li>
</ul>

<h2 id="edit">Edit</h2>

<p>Suite à la publication de l’article, <a href="@oncletom@framapiaf.org">Thomas</a>, qui est bien acoquiné avec data.gouv.fr, me signale d’autres ressources qui m’avaient échappées&nbsp;:</p>
<ul>
  <li>En bas de la <a href="https://www.data.gouv.fr/fr/datasets/base-sirene-des-entreprises-et-de-leurs-etablissements-siren-siret/">page de téléchargement</a> du répertoire, il y a aussi à disposition des «&#8239;Ressources communautaires&#8239;» (dont le répertoire géocodé) et des cas de réutilisations.</li>
  <li><a href="https://github.com/sgmap/sirene_as_api">Sirene as API</a>&nbsp;: travaux en cours pour fournir une API au répertoire SIRENE, en Ruby en Rails et Vue.js (yeah!)</li>
</ul>

  </div>

  <!-- DESKTOP -->

<table class="table table-meta hide-xs">
  <tbody>
    <tr>
      <!-- previous page -->
      
        <td class="table-read-link">
          <a class="post-link" href="/good_job/2017/08/14/liens-semaine.html"
          title="Article précédent : Je passe trop de temps sur internet - semaine 32">
            <span class="icon icon-arrow-left2"></span>
          </a>
        </td>
      

      <!-- date to display -->
      <td>
        <span title="Date de publication">
          <span class="icon icon-calendar"></span>
          <span>
              20 Aug 2017
            </span>
        </span>
      </td>

      <!-- reading time -->
      <td>
        <span>
<span title=" Environ 
  15
 min de lecture">
  <span class="icon icon-clock">
    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-clock"></use>
  </span>
  
  15
 min
</span>
</span>
      </td>

      <!-- lubies -->
      <td>
        <a class="link-underline" href="/lubies/sustainable_code">
          <span>code décroissant</span>
        </a>
      </td>
      <!-- Tags -->
      
        <td>
          <span class="icon icon-price-tag"></span>
          
          <a class="link-underline tag-list" href="/tags/données">
            <span class="">données</span>
          </a>
          
          <a class="link-underline tag-list" href="/tags/cartographie">
            <span class="">cartographie</span>
          </a>
          
        </td>
      

      
        <td class="table-read-link">
          <a class="post-link float-right" href="/good_job/2017/08/21/liens-semaine-33.html"
            title="Article suivant : Je passe trop de temps sur internet - semaine 33">
            <span class="icon icon-arrow-right2"></span>
          </a>
        </td>
      

    </tr>
  </tbody>
</table>

<!-- MOBILE ================================================================-->

<table class="table table-meta show-xs">
  <tbody>
    <tr>
      <!-- date to display -->
      <td>
        <span title="Date de publication">
          <span class="icon icon-calendar"></span>
          <span>
            20 Aug 17
          </span>
        </span>
      </td>
      <!-- lubies -->
      <td>
        <a class="link-underline" href="/lubies/sustainable_code">
          <span>code décroissant</span>
        </a>
      </td>
    </tr>

    <tr>
      <!-- reading time -->
      <td>
        <span>
<span title=" Environ 
  15
 min de lecture">
  <span class="icon icon-clock">
    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-clock"></use>
  </span>
  
  15
 min
</span>
</span>
      </td>

      <!-- Tags -->
        <td>
          
          <span class="icon icon-price-tag"></span>
          
          <a class="link-underline tag-list" href="/tags/données">
            <span class="">données</span>
          </a>
          
          <a class="link-underline tag-list" href="/tags/cartographie">
            <span class="">cartographie</span>
          </a>
          
          
        </td>
    </tr>

      <!-- previous page -->
      <td class="table-read-link">
        
        <a class="post-link" href="/good_job/2017/08/14/liens-semaine.html"
        title="Article précédent : Je passe trop de temps sur internet - semaine 32">
        <span class="icon icon-arrow-left2"></span>
      </a>
      
    </td>

        <td class="table-read-link">
          
          <a class="post-link float-right" href="/good_job/2017/08/21/liens-semaine-33.html"
            title="Article suivant : Je passe trop de temps sur internet - semaine 33">
            <span class="icon icon-arrow-right2"></span>
          </a>
          
        </td>
    </tr>



  </tbody>
</table>


</article>

        </div>
      </div>

    </div>

  </div>



</body>
</html>